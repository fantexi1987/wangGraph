<!--
  Copyright (c) 2006-2018, JGraph Ltd
  
  Hello, World! example for wGraph.wangGraph. This example demonstrates using
  a DOM node to create a graph and adding vertices and edges.
-->
<html>
<head>
	<title>Hello, World! example for wGraph.wangGraph</title>

	<!-- Sets the basepath for the library if not in same directory -->
	<script type="text/javascript">
		wangBasePath = '../dist';
	</script>

	<!-- Loads and initializes the library -->
	<script type="text/javascript" src="../dist/wangGraph.umd.js"></script>

	<!-- Example code -->
	<script type="text/javascript">
		// Object.keys(window.wGraph).forEach(wangGraphClassName => { window[wangGraphClassName] = window.wGraph[wangGraphClassName]; });
		// Program starts here. Creates a sample graph in the
		// DOM node with the specified ID. This function is invoked
		// from the onLoad event handler of the document (see below).
		wGraph.wangGraph.prototype.getAllConnectionConstraints = function(terminal, source)
		{
			if (terminal != null && terminal.shape != null)
			{
				if (terminal.shape.stencil != null)
				{
					if (terminal.shape.stencil.constraints != null)
					{
						return terminal.shape.stencil.constraints;
					}
				}
				else if (terminal.shape.constraints != null)
				{
					return terminal.shape.constraints;
				}
			}
	
			return null;
		};
	
		// Defines the default constraints for all shapes
		wGraph.wangShape.prototype.constraints = [new wGraph.wangConnectionConstraint(new wGraph.wangPoint(0.25, 0), true),
										 new wGraph.wangConnectionConstraint(new wGraph.wangPoint(0.5, 0), true),
										 new wGraph.wangConnectionConstraint(new wGraph.wangPoint(0.75, 0), true),
		        	              		 new wGraph.wangConnectionConstraint(new wGraph.wangPoint(0, 0.25), true),
		        	              		 new wGraph.wangConnectionConstraint(new wGraph.wangPoint(0, 0.5), true),
		        	              		 new wGraph.wangConnectionConstraint(new wGraph.wangPoint(0, 0.75), true),
		        	            		 new wGraph.wangConnectionConstraint(new wGraph.wangPoint(1, 0.25), true),
		        	            		 new wGraph.wangConnectionConstraint(new wGraph.wangPoint(1, 0.5), true),
		        	            		 new wGraph.wangConnectionConstraint(new wGraph.wangPoint(1, 0.75), true),
		        	            		 new wGraph.wangConnectionConstraint(new wGraph.wangPoint(0.25, 1), true),
		        	            		 new wGraph.wangConnectionConstraint(new wGraph.wangPoint(0.5, 1), true),
		        	            		 new wGraph.wangConnectionConstraint(new wGraph.wangPoint(0.75, 1), true)];
		
		// Edges have no connection points
		wGraph.wangPolyline.prototype.constraints = null;
		function main(container)
		{
			// Checks if the browser is supported
			if (!wGraph.wangClient.isBrowserSupported())
			{
				// Displays an error message if the browser is not supported.
				wGraph.wangUtils.error('Browser is not supported!', 200, false);
			}
			else
			{
				// Disables the built-in context menu
				wGraph.wangEvent.disableContextMenu(container);
				
				// Creates the graph inside the given container
				var graph = new wGraph.wangGraph(container);

				graph.setConnectable(true);

				// Enables rubberband selection
				new wGraph.wangRubberband(graph);

				graph.setPanning(true);
				graph.panningHandler.useLeftButtonForPanning = true;
				
				// Gets the default parent for inserting new cells. This
				// is normally the first child of the root (ie. layer 0).
				var parent = graph.getDefaultParent();
								
				// Adds cells to the model in a single step
				graph.getModel().beginUpdate();
				try
				{
					var v1 = graph.insertVertex(parent, null, 'Hello,', 20, 20, 80, 30);
					var v2 = graph.insertVertex(parent, null, 'World!', 200, 150, 80, 30);
					var e1 = graph.insertEdge(parent, null, '', v1, v2);

					for(var i = 0;i<1000;i++) {
						var x = 50 + i*100;
						var v = graph.insertVertex(parent, null, 'test' + i, x, 60,80, 30);
					}
				}
				finally
				{
					// Updates the display
					graph.getModel().endUpdate();
				}
			}
		};
	</script>
</head>

<!-- Page passes the container for the graph to the program -->
<body onload="main(document.getElementById('graphContainer'))">

	<!-- Creates a container for the graph with a grid wallpaper -->
	<div id="graphContainer"
		style="position:relative;overflow:hidden;width:1321px;height:541px;background:url('editors/images/grid.gif');cursor:default;">
	</div>
</body>
</html>
